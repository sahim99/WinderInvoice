{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Breadcrumbs -->
    <nav class="flex mb-8" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-4">
            <li>
                <div>
                    <a href="/customers" class="text-gray-400 hover:text-gray-200 transition-colors">
                        <svg class="flex-shrink-0 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                        </svg>
                        <span class="sr-only">Home</span>
                    </a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="flex-shrink-0 h-5 w-5 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z" />
                    </svg>
                    <a href="/customers" class="ml-4 text-sm font-medium text-gray-400 hover:text-gray-200 transition-colors">Customers</a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <svg class="flex-shrink-0 h-5 w-5 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z" />
                    </svg>
                    <a href="#" class="ml-4 text-sm font-medium text-blue-500" aria-current="page">Edit Customer</a>
                </div>
            </li>
        </ol>
    </nav>

    <div class="md:grid md:grid-cols-3 md:gap-6 mb-8">
        <div class="md:col-span-1">
            <h3 class="text-2xl font-bold leading-6 text-white">Edit Customer</h3>
            <p class="mt-2 text-sm text-gray-400">Update customer details. Fields marked with <span class="text-red-500">*</span> are required.</p>
        </div>
        <div class="mt-5 md:mt-0 md:col-span-2">
            <form action="/customers/{{ customer.id }}/edit" method="POST">
                <div class="bg-[#111] shadow-xl sm:rounded-xl border border-gray-800 card-gradient overflow-hidden">
                    <div class="px-4 py-5 sm:p-6 space-y-8">
                        
                        <!-- SECTION: Customer Info -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Customer Info</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="name" class="block text-sm font-medium text-gray-300 mb-1">Customer Name <span class="text-red-500">*</span></label>
                                    <input type="text" name="name" id="name" value="{{ customer.name }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="contact_person" class="block text-sm font-medium text-gray-300 mb-1">Contact Person</label>
                                    <input type="text" name="contact_person" id="contact_person" value="{{ customer.contact_person or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="party_code" class="block text-sm font-medium text-gray-300 mb-1">Party Code</label>
                                    <input type="text" name="party_code" id="party_code" value="{{ customer.party_code or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Billing Information -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Billing Information</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="billing_address" class="block text-sm font-medium text-gray-300 mb-1">Billing Address <span class="text-red-500">*</span></label>
                                    <textarea name="billing_address" id="billing_address" rows="3" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">{{ customer.billing_address }}</textarea>
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="city" class="block text-sm font-medium text-gray-300 mb-1">City <span class="text-red-500">*</span></label>
                                    <input type="text" name="city" id="city" value="{{ customer.city or '' }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="pincode" class="block text-sm font-medium text-gray-300 mb-1">PIN Code</label>
                                    <input type="text" name="pincode" id="pincode" value="{{ customer.pincode or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="state" class="block text-sm font-medium text-gray-300 mb-1">State <span class="text-red-500">*</span></label>
                                    <input type="text" name="state" id="state" value="{{ customer.state }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="state_code" class="block text-sm font-medium text-gray-300 mb-1">State Code <span class="text-red-500">*</span></label>
                                    <input type="text" name="state_code" id="state_code" value="{{ customer.state_code }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Shipping Information -->
                        <div>
                            <div class="flex items-center justify-between mb-4 border-b border-gray-800 pb-2">
                                <h4 class="text-lg font-medium text-white">Shipping Information</h4>
                                <div class="flex items-center">
                                    <input id="same_as_billing" name="same_as_billing" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-700 rounded bg-black">
                                    <label for="same_as_billing" class="ml-2 block text-sm text-gray-300">
                                        Same as billing
                                    </label>
                                </div>
                            </div>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="shipping_address" class="block text-sm font-medium text-gray-300 mb-1">Shipping Address <span class="text-red-500">*</span></label>
                                    <textarea name="shipping_address" id="shipping_address" rows="3" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">{{ customer.shipping_address }}</textarea>
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Tax Details -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Tax Details</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="gstin" class="block text-sm font-medium text-gray-300 mb-1">GSTIN</label>
                                    <input type="text" name="gstin" id="gstin" value="{{ customer.gstin or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="pan" class="block text-sm font-medium text-gray-300 mb-1">PAN</label>
                                    <input type="text" name="pan" id="pan" value="{{ customer.pan or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="place_of_supply" class="block text-sm font-medium text-gray-300 mb-1">Place of Supply <span class="text-red-500">*</span></label>
                                    <input type="text" name="place_of_supply" id="place_of_supply" value="{{ customer.place_of_supply or '' }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="price_category" class="block text-sm font-medium text-gray-300 mb-1">Price Category</label>
                                    <select name="price_category" id="price_category"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500">
                                        <option value="Retail" {% if customer.price_category == 'Retail' %}selected{% endif %}>Retail</option>
                                        <option value="Wholesale" {% if customer.price_category == 'Wholesale' %}selected{% endif %}>Wholesale</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Contact Details -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Contact Details</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="phone" class="block text-sm font-medium text-gray-300 mb-1">Phone <span class="text-red-500">*</span></label>
                                    <input type="text" name="phone" id="phone" value="{{ customer.phone or '' }}" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="email" class="block text-sm font-medium text-gray-300 mb-1">Email</label>
                                    <input type="email" name="email" id="email" value="{{ customer.email or '' }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Finance -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Finance</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="opening_balance" class="block text-sm font-medium text-gray-300 mb-1">Opening Balance</label>
                                    <input type="number" step="0.01" name="opening_balance" id="opening_balance"
                                        value="{{ customer.opening_balance }}"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3 flex items-end pb-2">
                                    <span class="text-sm text-gray-500">Balance Type: Credit (Default)</span>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="px-4 py-3 bg-black/50 text-right sm:px-6 border-t border-gray-800">
                        <button type="submit"
                            class="inline-flex justify-center py-2 px-6 border border-transparent shadow-lg text-sm font-bold rounded-lg text-white bg-blue-600 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all btn-scale">
                            Update Customer
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Script to handle "Same as billing" checkbox
    document.getElementById('same_as_billing').addEventListener('change', function() {
        if(this.checked) {
            document.getElementById('shipping_address').value = document.getElementById('billing_address').value;
        } else {
            document.getElementById('shipping_address').value = '';
        }
    });

    // Auto-fill Place of Supply from State
    document.getElementById('state').addEventListener('input', function() {
        document.getElementById('place_of_supply').value = this.value;
    });
</script>
{% endblock %}