{% extends "base.html" %}

{% block content %}
{# Set breadcrumb for subpage header #}
{% set breadcrumb = [
  {'href': '/dashboard', 'label': 'Home'},
  {'href': '/customers', 'label': 'Customers'},
  {'href': request.url.path, 'label': 'Add Customer'}
] %}
{% include 'partials/subpage_header.html' %}

<div class="w-full max-w-[1600px] mx-auto px-6 lg:px-12 py-8">
    <div class="md:grid md:grid-cols-3 md:gap-6 mb-8">
        <div class="md:col-span-1">
            <h3 class="text-2xl font-bold leading-6 text-white">New Customer</h3>
            <p class="mt-2 text-sm text-gray-400">Add a new customer to your database. Fill in all required fields marked with <span class="text-red-500">*</span>.</p>
        </div>
        <div class="mt-5 md:mt-0 md:col-span-2">
            <form action="/customers/new" method="POST">
                <div class="bg-[#111] shadow-xl sm:rounded-xl border border-gray-800 card-gradient overflow-hidden">
                    <div class="px-4 py-5 sm:p-6 space-y-8">
                        
                        <!-- SECTION: Customer Info -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Customer Info</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="name" class="block text-sm font-medium text-gray-300 mb-1">Customer Name <span class="text-red-500">*</span></label>
                                    <input type="text" name="name" id="name" required
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="contact_person" class="block text-sm font-medium text-gray-300 mb-1">Contact Person</label>
                                    <input type="text" name="contact_person" id="contact_person"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="party_code" class="block text-sm font-medium text-gray-300 mb-1">Party Code</label>
                                    <input type="text" name="party_code" id="party_code"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Contact Details -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Contact Details</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="phone" class="block text-sm font-medium text-gray-300 mb-1">Phone <span class="text-red-500">*</span></label>
                                    <input type="tel" name="phone" id="phone" required
                                        placeholder="+91 9876543210"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="email" class="block text-sm font-medium text-gray-300 mb-1">Email</label>
                                    <input type="email" name="email" id="email"
                                        placeholder="name@example.com"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Billing Information -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Billing Information</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="billing_address" class="block text-sm font-medium text-gray-300 mb-1">Billing Address <span class="text-red-500">*</span></label>
                                    <textarea name="billing_address" id="billing_address" rows="3" required
                                        placeholder="Enter billing address..."
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600"></textarea>
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="city" class="block text-sm font-medium text-gray-300 mb-1">City <span class="text-red-500">*</span></label>
                                    <input type="text" name="city" id="city" required
                                        placeholder="City"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="pincode" class="block text-sm font-medium text-gray-300 mb-1">PIN Code</label>
                                    <input type="text" name="pincode" id="pincode"
                                        placeholder="PIN Code"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="state" class="block text-sm font-medium text-gray-300 mb-1">State <span class="text-red-500">*</span></label>
                                    <input type="text" name="state" id="state" required
                                        placeholder="State"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="state_code" class="block text-sm font-medium text-gray-300 mb-1">State Code <span class="text-red-500">*</span></label>
                                    <input type="text" name="state_code" id="state_code" required
                                        placeholder="State Code (e.g., 27)"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Shipping Information -->
                        <div>
                            <div class="flex items-center justify-between mb-4 border-b border-gray-800 pb-2">
                                <h4 class="text-lg font-medium text-white">Shipping Information</h4>
                                <div class="flex items-center">
                                    <input id="same_as_billing" name="same_as_billing" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-700 rounded bg-black">
                                    <label for="same_as_billing" class="ml-2 block text-sm text-gray-300">
                                        Same as billing
                                    </label>
                                </div>
                            </div>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6">
                                    <label for="shipping_address" class="block text-sm font-medium text-gray-300 mb-1">Shipping Address <span class="text-red-500">*</span></label>
                                    <textarea name="shipping_address" id="shipping_address" rows="3" required
                                        placeholder="Enter shipping address..."
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Tax Details -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Tax Details</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="gstin" class="block text-sm font-medium text-gray-300 mb-1">GSTIN</label>
                                    <input type="text" name="gstin" id="gstin"
                                        placeholder="22AAAAA0000A1Z5"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="pan" class="block text-sm font-medium text-gray-300 mb-1">PAN</label>
                                    <input type="text" name="pan" id="pan"
                                        placeholder="AAAAA0000A"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="place_of_supply" class="block text-sm font-medium text-gray-300 mb-1">Place of Supply <span class="text-red-500">*</span></label>
                                    <input type="text" name="place_of_supply" id="place_of_supply" required
                                        placeholder="Place of Supply"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="price_category" class="block text-sm font-medium text-gray-300 mb-1">Price Category</label>
                                    <select name="price_category" id="price_category"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500">
                                        <option value="Retail">Retail</option>
                                        <option value="Wholesale">Wholesale</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- SECTION: Finance -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4 border-b border-gray-800 pb-2">Finance</h4>
                            <div class="grid grid-cols-6 gap-6">
                                <div class="col-span-6 sm:col-span-3">
                                    <label for="opening_balance" class="block text-sm font-medium text-gray-300 mb-1">Opening Balance</label>
                                    <input type="number" step="0.01" name="opening_balance" id="opening_balance"
                                        value="0.00"
                                        class="block w-full shadow-sm sm:text-sm bg-black border-gray-700 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500 placeholder-gray-600">
                                </div>
                                <div class="col-span-6 sm:col-span-3 flex items-end pb-2">
                                    <span class="text-sm text-gray-500">Balance Type: Credit (Default)</span>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="px-4 py-3 bg-black/50 text-right sm:px-6 border-t border-gray-800">
                        <button type="submit"
                            class="inline-flex justify-center py-2 px-6 border border-transparent shadow-lg text-sm font-bold rounded-lg text-white bg-blue-600 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all btn-scale">
                            Save Customer
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Script to handle "Same as billing" checkbox
    document.getElementById('same_as_billing').addEventListener('change', function() {
        if(this.checked) {
            document.getElementById('shipping_address').value = document.getElementById('billing_address').value;
        } else {
            document.getElementById('shipping_address').value = '';
        }
    });

    // Auto-fill Place of Supply from State
    document.getElementById('state').addEventListener('input', function() {
        document.getElementById('place_of_supply').value = this.value;
    });
</script>
{% endblock %}